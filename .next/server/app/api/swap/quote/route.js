"use strict";(()=>{var e={};e.id=717,e.ids=[717],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6029:(e,o,t)=>{t.r(o),t.d(o,{originalPathname:()=>A,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var r={};t.r(r),t.d(r,{GET:()=>l});var n=t(9303),s=t(8716),a=t(670),i=t(7070);let c=process.env.ONEINCH_API_KEY,p={"0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE":"ethereum","0xdAC17F958D2ee523a2206206994597C13D831ec7":"tether","0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48":"usd-coin","0x6B175474E89094C44Da98b954EedeAC495271d0F":"dai","0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599":"wrapped-bitcoin"};async function l(e){let{searchParams:o}=new URL(e.url),t=o.get("chainId"),r=o.get("src"),n=o.get("dst"),s=o.get("amount");if(!t||!r||!n||!s)return i.NextResponse.json({error:"Missing required parameters"},{status:400});if(c)try{let e=`https://api.1inch.dev/swap/v6.0/${t}/quote?src=${r}&dst=${n}&amount=${s}`;console.log("Trying 1inch API...");let o=await fetch(e,{headers:{Authorization:`Bearer ${c}`,Accept:"application/json"}});if(o.ok){let e=await o.json();return console.log("âœ… 1inch success!"),i.NextResponse.json({toTokenAmount:e.dstAmount||e.toTokenAmount||e.toAmount,fromTokenAmount:s,estimatedGas:e.estimatedGas||e.gas||"180000",protocols:e.protocols||[["1inch"]],source:"1inch"},{headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}})}console.log("1inch failed:",o.status)}catch(e){console.log("1inch error, falling back to price estimate")}try{let e=p[r],o=p[n];if(!e||!o)return console.error("Token not supported:",{src:r,dst:n}),i.NextResponse.json({toTokenAmount:"0",estimatedGas:"200000",error:"Token pair not supported"},{headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}});let t=`https://api.coingecko.com/api/v3/simple/price?ids=${e},${o}&vs_currencies=usd`;console.log("Fetching prices from CoinGecko:",t);let a=await fetch(t,{headers:{Accept:"application/json"}});if(!a.ok)throw Error(`CoinGecko API error: ${a.status}`);let c=await a.json();console.log("Price data:",c);let l=c[e]?.usd,u=c[o]?.usd;if(!l||!u)throw Error("Price data unavailable");let d=Number(s)/1e18,h=d*l,m=h/u,A="0xdAC17F958D2ee523a2206206994597C13D831ec7"===n?6:18,g=Math.floor(.997*Math.floor(m*10**A));return console.log("Swap calculation:",{amountInEth:d,srcPrice:l,dstPrice:u,valueInUsd:h,outputAmount:m,outputWithFee:g}),i.NextResponse.json({toTokenAmount:g.toString(),fromTokenAmount:s,estimatedGas:"180000",protocols:[["CoinGecko estimate"]],source:"coingecko"},{headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}})}catch(e){return console.error("Error calculating swap quote:",e),i.NextResponse.json({toTokenAmount:"0",estimatedGas:"200000",error:"Unable to calculate swap quote"},{headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}})}}let u=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/swap/quote/route",pathname:"/api/swap/quote",filename:"route",bundlePath:"app/api/swap/quote/route"},resolvedPagePath:"/Users/rickschlimback/Desktop/Crypto wallet app/app/api/swap/quote/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:m}=u,A="/api/swap/quote/route";function g(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}}};var o=require("../../../../webpack-runtime.js");o.C(e);var t=e=>o(o.s=e),r=o.X(0,[948,972],()=>t(6029));module.exports=r})();